{"version":3,"sources":["webpack:///./src/root.styles.css?4ada","webpack:///./src/root.styles.css","webpack:///./src/global.css?b2d7","webpack:///./src/global.css","webpack:///./src/translations/index.ts","webpack:///./src/utils/translations.ts","webpack:///./src/openmrs-esm-refapp-navigation.tsx","webpack:///./src/root.component.tsx"],"names":["content","module","i","options","transform","undefined","locals","exports","push","en","translations","fr","setLanguage","language","i18n","changeLanguage","singleSpaReact","React","ReactDOM","rootComponent","props","useState","isLoggedIn","setIsLoggedIn","userName","setUserName","locale","setLocale","type","url","navBarConfig","setNavBarConfig","resources","hookFunction","property","hook","updateFn","use","initReactI18next","init","lng","keySeparator","interpolation","escapeValue","fallbackLng","ns","defaultNS","getTranslationConfig","split","getLanguageCode","initI18n","useEffect","logoutPath","sub","getCurrentUser","includeAuthStatus","subscribe","user","authenticated","display","setCurrentUserDetails","configPromise","openmrsFetch","defaultNavBarConfig","Promise","resolve","then","configResponse","data","error","console","log","unsubscribe","window","location","href","className","title","styles","src","alt","bootstrap","mount","unmount"],"mappings":"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","file":"2.openmrs-esm-refapp-navigation.js","sourcesContent":["\nvar content = require(\"!!../node_modules/css-loader/dist/cjs.js??ref--5-1!./root.styles.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../node_modules/css-loader/dist/cjs.js??ref--5-1!./root.styles.css\", function() {\n\t\tvar newContent = require(\"!!../node_modules/css-loader/dist/cjs.js??ref--5-1!./root.styles.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"._2_6bIRZOTMYLdshFof092n {\\n  text-align: right;\\n  display: flex;\\n  align-items: center;\\n  margin-right: 10px;\\n}\\n\\n._3cXXNhzQQCYVtjZOghfKrs {\\n  margin-right: 10px;\\n}\\n\\n._3cXXNhzQQCYVtjZOghfKrs span {\\n  margin-left: 5px;\\n}\\n\\n._3BV1nRQeBguEGZmM5hfaJw {\\n  height: 60px;\\n  width: 120px;\\n}\\n\", \"\"]);\n// Exports\nexports.locals = {\n\t\"action-container\": \"_2_6bIRZOTMYLdshFof092n\",\n\t\"username\": \"_3cXXNhzQQCYVtjZOghfKrs\",\n\t\"custom-logo\": \"_3BV1nRQeBguEGZmM5hfaJw\"\n};","\nvar content = require(\"!!../node_modules/css-loader/dist/cjs.js??ref--5-1!./global.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../node_modules/css-loader/dist/cjs.js??ref--5-1!./global.css\", function() {\n\t\tvar newContent = require(\"!!../node_modules/css-loader/dist/cjs.js??ref--5-1!./global.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../node_modules/css-loader/dist/runtime/api.js\")(false);\n// Module\nexports.push([module.id, \"\", \"\"]);\n","import en from \"./en.json\";\nimport fr from \"./fr.json\";\n\nexport default {\n  en: {\n    translations: en\n  },\n  fr: {\n    translations: fr\n  }\n};\n","import i18n from \"i18next\";\nimport { initReactI18next } from \"react-i18next\";\n\nexport function initAndHook<T>(\n  property: T,\n  hook: Function,\n  updateFn: (propety: T) => void\n): void {\n  updateFn(property);\n  hook(() => {\n    updateFn(property);\n  }, [property]);\n}\n\nconst getTranslationConfig = (resources: any): any => ({\n  resources,\n  lng: \"en\",\n  keySeparator: false,\n  interpolation: {\n    escapeValue: false\n  },\n  fallbackLng: \"en\",\n  ns: [\"translations\"],\n  defaultNS: \"translations\"\n});\n\nexport const setLanguage = (language: string): void => {\n  i18n.changeLanguage(language ? language : \"en\");\n};\n\nconst getLanguageCode = locale => locale.split(\"_\")[0];\n\nexport const initI18n = (\n  resources: any,\n  locale: string,\n  hookFunction: Function\n): void => {\n  i18n.use(initReactI18next).init(getTranslationConfig(resources));\n  initAndHook(getLanguageCode(locale), hookFunction, setLanguage);\n};\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport singleSpaReact from \"single-spa-react\";\nimport Root from \"./root.component\";\nimport \"./global.css\";\n\nconst { bootstrap, mount, unmount } = singleSpaReact({\n  React,\n  ReactDOM,\n  rootComponent: Root\n});\n\nexport { bootstrap, mount, unmount };\n","import React, { useEffect, useState } from \"react\";\nimport { openmrsFetch, getCurrentUser } from \"@openmrs/esm-api\";\n\nimport resources from \"./translations\";\nimport { initI18n } from \"./utils/translations\";\n\nimport styles from \"./root.styles.css\";\nimport { Trans } from \"react-i18next\";\n\nexport default function Root(props: RootProps) {\n  const [isLoggedIn, setIsLoggedIn] = useState(true);\n  const [userName, setUserName] = useState(null);\n  const [locale, setLocale] = useState(\"en\");\n  const [navBarConfig, setNavBarConfig] = useState({ type: \"\", url: \"\" });\n  initI18n(resources, locale, useEffect);\n\n  const logoutPath = \"/openmrs/appui/header/logout.action?successUrl=openmrs\";\n\n  const setCurrentUserDetails = user => {\n    if (user.authenticated) {\n      setIsLoggedIn(true);\n      setUserName(user.user.display);\n      setLocale(user.locale);\n    } else {\n      setIsLoggedIn(false);\n    }\n  };\n\n  useEffect(() => {\n    const sub = getCurrentUser({ includeAuthStatus: true }).subscribe(user =>\n      setCurrentUserDetails(user)\n    );\n\n    const configPath = \"/frontend/headerConfig\";\n    const configPromise = openmrsFetch(`${configPath}.json`);\n    const defaultNavBarConfig = { type: \"default\", url: \"\" };\n\n    Promise.resolve(configPromise)\n      .then(configResponse => {\n        setNavBarConfig(configResponse.data);\n      })\n      .catch(error => {\n        console.log(`Unable to load the header configuration: ${error}`); // eslint-disable-line\n        setNavBarConfig(defaultNavBarConfig);\n      });\n\n    return () => sub.unsubscribe();\n  }, []);\n\n  useEffect(() => {\n    if (!isLoggedIn) {\n      window.location.href = logoutPath;\n    }\n  }, [isLoggedIn]);\n\n  function getLogo() {\n    if (navBarConfig.type == \"\") {\n      return \"\";\n    }\n    return navBarConfig.type == \"custom\" ? (\n      <img\n        className={styles[\"custom-logo\"]}\n        src={`../${navBarConfig.url}`}\n        alt=\"custom-logo\"\n      />\n    ) : (\n      <span></span>\n    );\n  }\n\n  return (\n    isLoggedIn && (\n      <div className={\"header\"}>\n        <div>\n          <a href=\"/openmrs\" className=\"logo\" title=\"navbar-logo\">\n            {getLogo()}\n          </a>\n        </div>\n        <div className={styles[\"action-container\"]}>\n          <a\n            href=\"/openmrs/adminui/myaccount/myAccount.page\"\n            className={styles[\"username\"]}\n          >\n            <i className=\"icon-user small\"></i>\n            <span>{userName}</span>\n          </a>\n          <a href={logoutPath}>\n            <Trans>Logout</Trans>\n            <i className=\"icon-signout small\"></i>\n          </a>\n        </div>\n      </div>\n    )\n  );\n}\n\ntype RootProps = {};\n"],"sourceRoot":""}